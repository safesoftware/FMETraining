<h2 id="learning-objectives">Learning Objectives</h2>
<p>After completing this lesson, you&rsquo;ll be able to:</p>
<ul>
<li>Create folders and upload datasets to Resources using the Upload button.</li>
<li>Run a workspace on FME Flow using data uploaded to Resources.</li>
<li>Author workspaces that automatically use data uploaded to Resources when running a workspace on FME Flow.</li>
</ul>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/CreateDataIntegrationApps/exercise-publish-data-with-a-workspace.fmwt" target="_blank" rel="noreferrer noopener">Starting workspace template</a> | C:\FMEData\Workspaces\CreateDataIntegrationApps\exercise-publish-data-with-a-workspace.fmwt</li>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/CreateDataIntegrationApps/exercise-publish-data-with-a-workspace-complete.fsproject" target="_blank" rel="noreferrer noopener">Starting FME Flow project</a> | C:\FMEData\Workspaces\CreateDataIntegrationApps\exercise-publish-data-with-a-workspace-complete.fsproject</li>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/CreateDataIntegrationApps/exercise-publish-data-with-a-workspace-complete.fmwt" target="_blank" rel="noreferrer noopener">Complete workspace template</a> | C:\FMEData\Workspaces\CreateDataIntegrationApps\exercise-publish-data-with-a-workspace-complete.fmwt</li>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/CreateDataIntegrationApps/exercise-use-the-resource-file-system-complete.fsproject" target="_blank" rel="noreferrer noopener">Complete FME Flow project</a> | C:\FMEData\Workspaces\CreateDataIntegrationApps\exercise-use-the-resource-file-system-complete.fsproject</li>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Data/Elections/ElectionVoting.gml" target="_blank" rel="noreferrer noopener">ElectionVoting.gml</a> | C:\FMEData\Data\Elections\ElectionVoting.gml</li>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Data/Elections/ElectionVoting.xsd" target="_blank" rel="noreferrer noopener">ElectionVoting.xsd</a> | C:\FMEData\Data\Elections\ElectionVoting.xsd</li>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Data/Boundaries/VancouverNeighborhoods.kml" target="_blank" rel="noreferrer noopener">VancouverNeighborhoods.kml</a> | C:\FMEData\Data\Boundaries\VancouverNeighborhoods.kml</li>
</ul>
<h2>Video</h2>
<!-- The script tag should live in the head of your page if at all possible -->
<p>
<script type="text/javascript" src="https://play.vidyard.com/embed/v4.js"></script>
</p>
<!-- Put this wherever you would like your player to appear -->
<p><img class="vidyard-player-embed" style="width: 100%; margin: auto; display: block;" src="https://play.vidyard.com/bWtCWTj2fsHW3xrrJLvoTM.jpg" data-uuid="bWtCWTj2fsHW3xrrJLvoTM" data-v="4" data-type="inline" /></p>
<h2 id="introduction">Introduction</h2>
<p>You have already created a workspace to translate data and published it to FME Flow, both with data and using data uploaded temporarily.</p>
<p>However, such data management tools are not particularly suited to a long-term project, so the task here is to upgrade workspaces to use datasets stored in a Resources folder. There we can store source data and write destination data.</p>
<h2 id="1-open-fme-server-web-interface">1) Open FME Flow Web Interface</h2>
<p>Log in to the FME Flow (2023.0 or later) web interface using an administrator account (admin/FMElearnings on Safe Software training machines). Click Resources on the side menu bar to navigate to the resources management pages.</p>
<h2 id="2-create-folder">2) Create Folder</h2>
<p>In most cases, data should be stored under the Data folder, so click on Data in the Resources dialog to open that folder. To avoid mixing datasets, our data should go into its own subfolder. So click on the +New button and create a folder called Election:</p>
<p><img class="image image-block image-center" src="https://lh5.googleusercontent.com/0CWJ1L_w5GZGOMOq4nydxmZlC-XFBFrUzb3OLFldIs-h4ayXGyUoc43nJPimfRdnEZKUN5yhmzuuNgaggC4XFw-8f1C1brRR9fs1wXbQpNIecF7R1RTqT1yGvKMQgnGSMsk9Om6KwZ5ubKPDk5YC7H4" alt="Creating a new folder" width="584" height="260" /></p>
<p>Next, click on the Election folder, and then create&nbsp;<strong>new</strong>&nbsp;subfolders called Input and Output:</p>
<p><img class="image image-block image-center" src="https://lh3.googleusercontent.com/0FqHaGdOcOtvlGz4czk34WjAIH0Rf-ua4tp-vZUMbz2s2vu9sk9wFdX4bcPTNpXE0BlZ7FhGlMoV-uFEZd-dCHKKDtVhPkT9ETHDt362INCq9KRLZ1T9Nf4qxMYiXfsveB-oNgcJjWqm4l3G4fGddr4" alt="Input and Output folders created" width="584" height="408" /></p>
<h2 id="3-upload-source-datasets">3) Upload Source Datasets</h2>
<p>Browse to the Input folder, click the Upload button, and select Files. Download the files below (right-click &gt; Save link as...) and then upload them as the source datasets for the current translation:</p>
<ul>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Data/Elections/ElectionVoting.gml" target="_blank" rel="noreferrer noopener">ElectionVoting.gml</a> | C:\FMEData\Data\Elections\ElectionVoting.gml</li>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Data/Elections/ElectionVoting.xsd" target="_blank" rel="noreferrer noopener">ElectionVoting.xsd</a> | C:\FMEData\Data\Elections\ElectionVoting.xsd</li>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Data/Boundaries/VancouverNeighborhoods.kml" target="_blank" rel="noreferrer noopener">VancouverNeighborhoods.kml</a> | C:\FMEData\Data\Boundaries\VancouverNeighborhoods.kml</li>
</ul>
<p>&nbsp;</p>
<p><img class="image image-block image-center" src="https://lh5.googleusercontent.com/ZJ7xLYY9YXEN2FLbKey03KutkGSNzJnaryEdzclaNd-ruFAEUcReLPG_al2h94GCAYdKn8BY9vs4RN0LykDbSM-6zizoX0CmyOckl-v7-6M-YZn9WuEQ19icoRhZBKZY4EGvIzBMY_wLYVqcK70luwM" alt="Uploaded source datasets" width="584" height="468" /></p>
<p>So we now have both source datasets and a folder to write the output data to.</p>
<h2 id="4-add-writer">4) Add Writer</h2>
<p>Until now, our workspaces have only had a NULL (dummy) writer. Now we know about Resources, we can add a proper writer and point the output dataset to the Resources Output folder.</p>
<p>So, open the&nbsp;<a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/CreateDataIntegrationApps/exercise-publish-data-with-a-workspace.fmwt" target="_blank" rel="noreferrer noopener">starting workspace template</a> in FME Workbench (2023.0 or later) and then select Writers &gt; Add Writer on the menu bar and set up a new writer with the following parameters:</p>
<table class="featureTable sort_table">
<tbody class="tbody">
<tr>
<td><strong>Writer Format</strong></td>
<td>Esri Geodatabase (File Geodb Open API)</td>
</tr>
<tr>
<td><strong>Writer Dataset</strong></td>
<td>C:\FMEData\Output\Training\DepartmentData.gdb</td>
</tr>
<tr>
<td><strong>Feature Class or Table Definition</strong></td>
<td>None (Advanced)</td>
</tr>
</tbody>
</table>
<p>We do not add feature types yet because we can move the existing ones from the NULL writer. So when you click OK, the workspace will look no different, but there will be a new writer in the Navigator window:</p>
<p><a href="https://s3.amazonaws.com/gitbook/Server-Authoring-2020/ServerAuthoring2DataHandling/Images/Img2.217.Ex2.AddedGeodatabaseWriter.png" target="_blank" rel="noreferrer noopener"><img class="image image-block image-center" src="https://lh5.googleusercontent.com/BeBq5RmDdHyvVC2XJ5R5V7py6_JQrONzkXQPVPrpGB5W0TARO_qjvYMeVkedLrksQjH5HaHyIUIfewGqbXLYzAR1MLD9mcEwzgbDh_choId8yraxlW5VJqMQtwOpN18FE7Xx0r6z7itJ2Nvlat2NJL0" alt="New FILEGDB Writer in the Navigator" width="279" height="271" /></a></p>
<h2 id="5-move-feature-types">5) Move Feature Types</h2>
<p>Inspect the parameters dialog for each writer feature type in turn. For each type, move it from the NULL writer to the FILE GDB writer, like so:</p>
<p><a href="https://s3.amazonaws.com/gitbook/Server-Authoring-2020/ServerAuthoring2DataHandling/Images/Img2.218.Ex2.MoveAFeatureType.png" target="_blank" rel="noreferrer noopener"><img class="image image-block image-center" src="https://lh6.googleusercontent.com/cQ9yBfUocQzHcVsB4WFn0OEEMGXMuvjzZmMzJ9ROQoFTkgXriz7AhVERt07BHnoD3_4Z9MQPr_5Bog-g_sg8grJyPzoAIcbHv_QQ_Uh8Z9_PLiiuHYEVc7zdBjO80NIfhJ7zSftVCx9C_arQtCrlT1U" alt="Moving a feature type from the NULL writer to the FILEGDB writer" width="547" height="313" /></a></p>
<p>This will expose several extra parameters. The key one to set is Geometry. Set the Neighborhoods feature type Geometry parameter to geodb_polygon:</p>
<p><a href="https://s3.amazonaws.com/gitbook/Server-Authoring-2020/ServerAuthoring2DataHandling/Images/Img2.219.Ex2.NeighborFeatureType.png" target="_blank" rel="noreferrer noopener"><img class="image image-block image-center" src="https://lh3.googleusercontent.com/FCwM7Tmu06zOAdpfXOb34og5oALAi_CMyOkfsI6XimH5YD42QlJex0CMuYxRsI3zLR1tzfcluLK17nGXvkpCIG_9pv1D5fwy0uu_JOOn4OY9tJy786iHwiDKpYYlrjyLK3QSjl3XOb7p1MXhxdwDVfI" alt="Setting the Geometry parameter" width="550" height="345" /></a></p>
<p>Set the VotingPlaces feature type Geometry parameter to geodb_point.</p>
<p>Now the two feature types belong to the Geodatabase writer, and the NULL writer can be deleted from the Navigator window if you wish.</p>
<h2 id="6-set-geodatabase-parameter">6) Set Geodatabase Parameter</h2>
<p>One last thing to change: locate the Geodatabase writer in the Navigator window and expand its list of parameters. Find the parameter labeled Overwrite Existing Geodatabase and enable it.</p>
<p><img class="image image-block image-center" src="https://lh6.googleusercontent.com/pXLHF5nB7ahWtlRkhDlfj8IF40amuosi69VZWIqO5_DlsUES4_vJIj99hXG6RKndDmeSv32wjN-YjUw7SmJFuXGcu9mw20qrld3pY5H0yblSgZdTwJzJdiyXlqSm7IC1Vw_cf0ZwJF0FvBIcEIpdFps" alt="Enable Overwrite Existing Geodatabase" width="704" height="304" /></p>
<p>This ensures we aren't continually adding data to the same dataset if we run the workspace more than once.</p>
<h2 id="7-run-workspace">7) Run Workspace</h2>
<p>Test run the workspace in FME Workbench. Inspect the output in Visual Preview. If it is not already selected, click Toggle Display Control on the left-hand side of the visual preview page. You should find the output is a Geodatabase containing seven tables (the Neighborhoods table and a separate table for each set of voting places).</p>
<p><a href="https://s3.amazonaws.com/gitbook/Server-Authoring-2020/ServerAuthoring2DataHandling/Images/Img2.221.Ex2.OutputTables.png" target="_blank" rel="noreferrer noopener"><img class="image image-block image-center" src="https://lh4.googleusercontent.com/iz8BT07VFpSia6r89F5wsWylqQpBgrIqrZZTjxBge7lLuJDVr4gVYTzQjjfEoFI62SKYyWYR2Vooos9hlpONcPDwUFYlNeYk1F3s0wDuoevVjc8kUZb1GjUig7nYeuTEojtl484lrmY5DYiYr8LsZyw" alt="Viewing results with multiple feature types" width="366" height="267" /></a></p>
<h2 id="8-publish-and-run-workspace">8) Publish and Run Workspace</h2>
<p>Publish the workspace to FME Flow (2023.0 or later). Do not upload data unless you have not completed the previous exercises. Register the workspace against the Job Submitter service.</p>
<p>Return to the FME Flow web interface. Locate the workspace under the Run Workspace dialog.</p>
<p><img class="image image-block image-center" src="https://lh5.googleusercontent.com/qf2nivUbZ0LiuRI-WhXOhTq03fr00H3ZSYbcGJr0qFcDTM00ZajSvjjEyta8TNjF-qb1r_8KPx4wTAbedp7hnb0mGgq7kqLMrehv3ADXc3d9DNuGWjR-IS9uh0XckMatjfua0naagxh4xW5pkcVBI-A" alt="Published parameters" width="719" height="611" /></p>
<p>For each file, click the Browse Resources button, browse to the Input subfolder in Resources, and select/set the file location. Since the Geodatabase does not exist yet, For the Geodatabase output location, you'll need to type the file name manually:</p>
<pre>$(FME_SHAREDRESOURCE_DATA)/Election/Output/DepartmentData.gdb</pre>
<p><img class="image image-block image-center" src="https://lh3.googleusercontent.com/_GteVCy3hDMP1ZwJ5qjgagn361QPvvJIy_2-EDlFKWAL1Tk3AD58ORn5nmkF5Vbyv0yjHa_XIzD39D9adOSjSpDFkpJdR4UNtK42x4r8_s9puQmzhGMFvnjWglYm-FKmaQ1iW0i7Pp9dqm9vZj0FhKU" alt="Specifying destination folder" width="800" height="441" /></p>
<p>Now when the workspace is run, a completed Geodatabase file should appear in the folder Resources\Data\Election\Output:</p>
<p><img class="image image-block image-center" src="https://lh4.googleusercontent.com/vr13LZhi9HzT5KavTdlFg_fzcBzq_WDlKxwU86YaWI6Q7DFlBB40gCXkUSXNhHXzlS2PXnyyBW21DXtaLgjI8E8fB9kYXFcRtGfrkI_gXVWNG9w6hnrzJiWv1Vmefk8-luGbPPouAN6zUsFgayx6OOM" alt="Written geodatabase appears in Resources folder" width="802" height="356" /></p>
<h2 id="9-apply-fme-server-parameter">9) Apply FME Flow Parameter</h2>
<p>Although the workspace ran correctly and used the data in the resources folder, that's only because we selected that data at runtime. It is not a permanent feature of the workspace.</p>
<p>It would be much better if we designed the workspace to look into the resources folders automatically.</p>
<p>So, return to the workspace in FME Workbench.</p>
<p>If we set the workspace to read from the resources folders, we don't want to give users the chance to change that. So in the Navigator window, locate the three parameters for source and destination datasets and delete them:</p>
<p><img class="image image-block image-center" src="https://lh6.googleusercontent.com/bHAXc6yPU8fekKiJnkJHHsakUoVNLsF8VcH-mOlwH33D8N_seyor4UPVv9d9LQlx4oPQFXTlRrXApYcjaLEuKixTGPsErDnkIQZkmC17oOFgLMt3Yd3Yn8jSvwcnx_eNXZAFmfRpVvK-xESaPwk8OG4" alt="Deleting the Source Google KML File or URL user parameter" width="671" height="452" /></p>
<h2 id="10-set-source-destination-parameters">10) Set Source/Destination Parameters</h2>
<p>Now, locate the source and destination dataset parameters for the two readers and one writer. Double-click each and change them to:</p>
<table class="featureTable sort_table">
<tbody class="tbody">
<tr>
<td>KML Reader</td>
<td>$(FME_SHAREDRESOURCE_DATA)\Election\Input\VancouverNeighborhoods.kml</td>
</tr>
<tr>
<td>GML Reader</td>
<td>$(FME_SHAREDRESOURCE_DATA)\Election\Input\ElectionVoting.gml</td>
</tr>
<tr>
<td>Geodatabase Writer</td>
<td>$(FME_SHAREDRESOURCE_DATA)\Election\Output\DepartmentData.gdb</td>
</tr>
</tbody>
</table>
<p><img class="image image-block image-center" src="https://lh4.googleusercontent.com/Zq9A2XI0HznmpsJeqfOh10Vgcl_ix2hy44vFMa3LksKrHCTMs4A-9WeNw5LKJFBT11LbIGgZl5gJHsswKABZyIai59_M_WF-GH5U41d1Ud56cNYz-se2hG0OMuvF7Yyl5dKK1Dp2Xo5AVbXN5ki3vjc" alt="Setting all paths using the FME Server parameter" width="705" height="606" /></p>
<p>Save the workspace and publish it back to FME Flow.</p>
<div class="box message info">
<div class="inner">
<div class="bd">
<div class="media">
<blockquote><img class="img mtm" role="presentation" src="https://safemytrailhead.s3.us-west-2.amazonaws.com/images/safe_note.png" alt="Note" /><br /><span style="font-family: inherit; font-size: 1em;">If you try running this workspace in FME Workbench now that you've updated the dataset parameters to use the FME Flow Shared Resource parameter, you will get an error because Workbench won't recognize that FME Flow parameter.</span></blockquote>
<div class="mediaBd">
<div class="message-media-content">
<p>If you still want to be able to test this workspace in Workbench, you can set a value for the FME_SHAREDRESOURCE_DATA parameter. Configure it to point to a local file path that matches the folder structure used on FME Flow. The workspace will still run on FME Flow as Flow will automatically override any value for that parameter and replace it with the correct path.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<h2 id="11-re-run-workspace">11) Re-Run Workspace</h2>
<p>Now run the workspace on FME Flow. This time you will not be prompted with a parameter to select the source (or destination) datasets, but they will be used from the resources folders just the same.</p>