<h2 id="learning-objectives">Learning Objectives</h2>
<p>After completing this lesson, you&rsquo;ll be able to:</p>
<ul>
<li>Explain the differences between SMTP and IMAP.</li>
<li>Awareness of available email templates.</li>
</ul>
<h2>Video</h2>
<!-- The script tag should live in the head of your page if at all possible -->
<p>
<script type="text/javascript" src="https://play.vidyard.com/embed/v4.js"></script>
</p>
<!-- Put this wherever you would like your player to appear -->
<p><img class="vidyard-player-embed" style="width: 100%; margin: auto; display: block;" src="https://play.vidyard.com/bWtCWTj2fsHW3xrrJLvoTM.jpg" data-uuid="bWtCWTj2fsHW3xrrJLvoTM" data-v="4" data-type="inline" /></p>
<h2 id="an-introduction-to-email-in-automations">An Introduction to Email in Automations</h2>
<p>It&rsquo;s important to cover email notifications in some detail because they are one of the most commonly used protocol types on FME Flow.</p>
<p>&ldquo;Email&rdquo; is a protocol that may be used by both Trigger and Action components in an Automations workflow. Email Triggers receive incoming emails from external clients, and Email Actions send emails out to an external account.</p>
<h2 id="email-protocols">Email Protocols</h2>
<p>Email is not a single protocol and there are several methods of email transfer. FME Flow supports two of these email-related protocols: <strong>SMTP</strong>&nbsp;and&nbsp;<strong>IMAP</strong>.</p>
<p>SMTP (Simple Mail Transfer Protocol) is the ability to&nbsp;<em>directly</em> receive an email through an email server built into FME Flow, or <em>indirectly</em>&nbsp;send an email through an SMTP service, for example, a Gmail account.</p>
<p>IMAP (Internet Message Access Protocol) is an&nbsp;<em>indirect</em> process that connects to an email account on a server elsewhere. When that account receives an email, the IMAP protocol passes it on to FME Flow.</p>
<h2 id="smtp-trigger">SMTP Trigger</h2>
<p>SMTP Triggers are used when data is sent to FME Flow via a direct email. FME Flow receives an email and triggers an Action in response.</p>
<p>Such triggers are possible because FME Flow includes a built-in email server as one of its components. However, this does require that the hostname and domain of your FME Flow should resolve to a publicly accessible IP or DNS.</p>
<div>
<div class="box message info">
<div class="inner">
<div class="bd">
<div class="media">
<blockquote><img class="img mtm" role="presentation" src="https://safemytrailhead.s3.us-west-2.amazonaws.com/images/safe_note.png" alt="Note" /><br /><br /><span style="font-family: inherit; font-size: 1em;">The steps to set up the built-in email server for notifications are documented in the&nbsp;</span><a style="font-family: inherit; font-size: 1em; background-color: #ffffff;" href="https://docs.safe.com/fme/html/FME-Flow/AdminGuide/Configuring-FME-Flow-to-Receive-Email.htm" target="_blank" rel="noopener">FME Flow Reference Manual</a><span style="font-family: inherit; font-size: 1em;">.</span></blockquote>
</div>
</div>
</div>
</div>
<p>However, FME Flow Hosted instances are automatically configured for email notifications and have a public domain name, so you don&rsquo;t need to do any additional setup.</p>
</div>
<h2 id="creating-an-smtp-trigger">Creating an SMTP Trigger</h2>
<p>Creating an SMTP Trigger is done in the Automations &gt; Create Automation section of the FME Flow web interface, by choosing the Email - SMTP (received) protocol as a new Trigger.</p>
<p><img class="image image-block image-center" src="https://lh4.googleusercontent.com/Xa1S9QalSoS6Ji0mBAGq-6WtJ7UrE2b-I36VikFETRCbusUvGh0h7PUyCUmWKFY6AUBXwNNQeeQh-QtwEVI-sOiYnUaP3cicLAqsayNLGtI8sDdElXWNr77ryBp3vmcEFYUTs14mDT5dXIgai2wSHiA" alt="Configuring Email - SMTP Details" width="355" height="357" /></p>
<p>Once the protocol type is selected, only the Email User Name parameter must be configured. This does not need to be an existing user or email; in the above example, it is set up to be AuthoringCourse. Note that you do not need to specify&nbsp;<em>@FMEFlowHostname.com</em>&nbsp;in the Email User Name parameter.</p>
<p>To construct the full email address, combine the Email Username with your FME Flow hostname. Now, for this example, whenever an email is sent to AuthoringCourse@<em>YourFMEFlowHostname</em> this Automation will receive an incoming message that contains the entire contents of that email, including the from and to address, and any attachments. This information is all processed by FME Flow so it can be used to trigger an Action downstream in the workspace.</p>
<p>In the SMTP trigger, there is an Optional Parameter to specify the location to download any email attachments. If this is not defined, the attachments will still be saved to a temporary location on FME Flow.</p>
<h2 id="imap-triggers">IMAP Triggers</h2>
<p>IMAP (Internet Message Access Protocol) is a variation on email for incoming notifications.</p>
<p>Instead of using the built-in email server, an IMAP Trigger connects to another email server and monitors it for incoming email. When a new email arrives in that account, the Automation is triggered.</p>
<h2 id="creating-an-imap-trigger">Creating an IMAP Trigger</h2>
<p>Like the SMTP protocol, IMAP Triggers are set up in the Automations &gt; Create Automation section of the web interface by creating a new or adding to an existing Automation, but this time choosing the Email -IMAP (received) protocol:</p>
<p><img class="image image-block image-center" src="https://lh6.googleusercontent.com/NoDQycCSoAnPKp8P67dYgdEypp3O80GhrOQKTE7EU_Z_LButfWQTVos1kZ-U38cFThW3g-IOW3XUAZv5EIzPuDUFGsrzwxJZypCr9FhyNZPUKtprVB16KmyvRusygQqQBxCasXY6wRgO1pfA-9h3vD4" alt="Configuring Email - IMAP Details" width="280" height="882" /></p>
<p>This Trigger has significantly more parameters, most are for defining the IMAP (Email) server connection.</p>
<p>There are two important parameters that let you decide what and when to watch this Email Server. Poll Interval determines how often FME Flow should check for emails. Emails to Fetch decides whether to fetch all unread emails or new emails only.</p>
<p>Like the SMTP Protocol, there is a parameter to select an FME Flow resource location in which to store any email attachments.</p>
<div>&nbsp;</div>
<div class="box message info">
<div class="inner">
<div class="bd">
<div class="media">
<blockquote><img class="img mtm" role="presentation" src="https://safemytrailhead.s3.us-west-2.amazonaws.com/images/safe_note.png" alt="Note" /><br /><br /><span style="font-family: inherit; font-size: 1em;">Most email servers support IMAP functionality, as do the majority of cloud-based email providers such as Gmail, Outlook.com, Yahoo!, etc.; so it&rsquo;s very easy to have FME Flow scan a Gmail account (for example) for incoming mail, and then act on its contents. FME Flow has the option to load templates for these popular email providers.</span></blockquote>
</div>
</div>
</div>
</div>