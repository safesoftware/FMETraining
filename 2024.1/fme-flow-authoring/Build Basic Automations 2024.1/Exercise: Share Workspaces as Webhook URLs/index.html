<h2 id="learning-objectives">Learning Objectives</h2>
<ul>
<li>Create a webhook URL.</li>
<li>Customize webhook URL parameters.</li>
</ul>
<h2 id="learning-objectives">Resources</h2>
<ul>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/CreateDataIntegrationApps/exercise-submit-job-through-webhook-url.fmwt" target="_self">Starting Workspace</a>
<ul>
<li><span style="font-weight: 400;"><span style="font-weight: 400;">C:\FMEData\Workspaces\CreateDataIntegrationApps\</span></span><span style="font-weight: 400;"><span data-sheets-root="1">exercise-submit-job-through-webhook-url.fmwt</span></span></li>
</ul>
</li>
</ul>
<h2>Introduction</h2>
<p><span style="font-weight: 400;">As a technical analyst in the GIS department, you want create to be able to access 311 service request data through a website or portal. You want users to be able to request the data by neighbourhood and have the results returned as a downloadable file using the Data Download service. This can be done through the use of Webhook URLs.</span></p>
<p><span style="font-weight: 400;">In this exercise, you&rsquo;ll create a Webhook URL that runs a workspace. You&rsquo;ll also learn how to modify values in the Webhook URL to edit workspace parameters.&nbsp;&nbsp;</span></p>
<h2>1) <span style="font-weight: 400;">Open FME Workbench</span></h2>
<p><span style="font-weight: 400;">Open <a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/CreateDataIntegrationApps/exercise-submit-job-through-webhook-url.fmwt" target="_self">starting workspace template</a> (</span><span style="font-weight: 400;">exercise-submit-job-through-webhook-url.fmwt) </span><span style="font-weight: 400;">in FME Workbench (2024.1 or later)</span></p>
<p><span style="font-weight: 400;"><img src="images/1724282600763.png" alt="Workspace" width="740" height="266" /></span></p>
<h2><span style="font-weight: 400;">2) Run the Workspace and Inspect Data</span></h2>
<p><span style="font-weight: 400;">Run the workspace then right-click on the </span><strong>311Requests</strong><span style="font-weight: 400;"> feature type to bring up the popup menu. Then click </span><strong>View Written Data...</strong><span style="font-weight: 400;"> to open the dataset in Visual Preview.&nbsp;</span></p>
<p><span style="font-weight: 400;"><img src="images/1727988540789.png" alt="View Written Data" width="584" height="253" /></span></p>
<p><span style="font-weight: 400;">You&rsquo;ll see all the open service requests. We should note what the data looks like so we will know where it has changed once we&rsquo;ve updated the feature type in the webhook URL.</span></p>
<p><span style="font-weight: 400;"><img src="images/1724282752275.png" alt="Visual Preview" width="592" height="339" /></span></p>
<h2><span style="font-weight: 400;">3) Publish Workspace</span></h2>
<p><span style="font-weight: 400;">Save the workspace as exercise-submit-job-through-webhook-url.fmwt and publish it to the <strong>Training</strong> repository in FME Flow. Make sure to check the <strong>Upload data files</strong> option. Register it with the<strong> Job Submitter</strong> and <strong>Data Download</strong> service. </span></p>
<p><span style="font-weight: 400;"><img src="images/1724282793922.png" alt="Publish to Flow" width="354" height="416" /></span></p>
<h2><span style="font-weight: 400;">4) Run on FME Flow</span></h2>
<p><span style="font-weight: 400;">Click the Direct Link to the workspace in the Translation Log <a href="http://localhost/fmeserver/workspaces/run/Flow%20Authoring/exercise-submit-job-through-webhook-URL.fmw">http://localhost/fmeserver/workspaces/run/Flow%20Authoring/exercise-submit-job-through-webhook-url.fmw</a> and log in if necessary.</span></p>
<p><span style="font-weight: 400;">Select Training as the Repository and set the Service to Data Download. Leave the default values for Feature Types to Read</span></p>
<p><span style="font-weight: 400;"><img src="images/1724282884488.png" alt="Run workspace" width="666" height="395" /></span></p>
<h2><span style="font-weight: 400;">5) Create a webhook URL</span></h2>
<p><span style="font-weight: 400;">Click on </span><strong>Workspace Actions</strong><span style="font-weight: 400;"> and select </span><strong>Create Webhook</strong><span style="font-weight: 400;">.</span></p>
<p><span style="font-weight: 400;"><img src="images/1724282929997.png" alt="Create webhook" /></span></p>
<h2><span style="font-weight: 400;">6) Configure the webhook URL</span></h2>
<p><span style="font-weight: 400;">Modify the default URL. Expand the Parameters panel. Try removing one of the values (e.g. &ldquo;Downtown&rdquo;) to see how it changes Webhook URL Preview in real-time.</span></p>
<p><span style="font-weight: 400;"><img src="images/1724283032319.png" alt="Webhook Preview" width="756" height="533" /></span></p>
<p><span style="font-weight: 400;">Select <strong>Reset </strong>to restore Parameter default values and click OK.</span></p>
<h2><span style="font-weight: 400;">7) Save the webhook</span></h2>
<p><span style="font-weight: 400;">Before doing anything else, select the Download Webhook button to save the webhook information to your desktop. This file contains information about the new Webhook URL. It is the only opportunity we get to save its newly created token.</span></p>
<p><span style="font-weight: 400;"><img src="images/1724283157859.png" alt="Save webhook" width="627" height="347" /></span></p>
<h2><span style="font-weight: 400;">8) Submit a Job by Webhook URL</span></h2>
<p><span style="font-weight: 400;">Open another browser window in incognito mode in order to test our new token. Paste the <strong>Authorization with Query String</strong> Webhook URL into the search bar and submit. You will receive a link to download a zip file containing the results as a GeoJSON file.</span></p>
<p><span style="font-weight: 400;"><img src="images/1724283212237.png" alt="Download link containing GeoJSON" width="852" height="231" /></span></p>
<h2><span style="font-weight: 400;">9) Inspect Data</span></h2>
<p><span style="font-weight: 400;">Download and extract the zip file and open the <strong>311-service-requests.geojson</strong> in FME Data Inspector to view the results</span></p>
<p><span style="font-weight: 400;"><img src="images/1724283300919.png" alt="Download results" /></span></p>
<h2><span style="font-weight: 400;">10) &nbsp;Submit a Job by Webhook URL with Updated Parameters</span></h2>
<p><span style="font-weight: 400;">Next to the query string&rsquo;s FEATURE_TYPES parameter, delete all the values except &ldquo;Downtown&rdquo; (including the URL encoding). The result will look like this URL:</span></p>
<p><code><a href="http://localhost/fmedatadownload/Training/exercise-submit-job-through-webhook-URL.fmw?FEATURE_TYPES=Downtown&amp;opt_showresult=false&amp;opt_servicemode=sync&amp;token="><span style="font-weight: 400;">http://localhost/fmedatadownload/Training/exercise-submit-job-through-webhook-URL.fmw?FEATURE_TYPES=Downtown&amp;opt_showresult=false&amp;opt_servicemode=sync&amp;token=</span></a><span style="font-weight: 400;">&lt;token&gt;</span></code></p>
<p><span style="font-weight: 400;">Submit to receive a new download link. Inspect the new GeoJSON file in FME Data Inspector again. This time, the output GeoJSON is clipped only to the &ldquo;Downtown&rdquo; selection.&nbsp;</span></p>
<p><span style="font-weight: 400;"><img src="images/1724283385619.png" alt="Downtown results" /></span></p>
<h2><span style="font-weight: 400;">11) View Jobs in FME Flow</span></h2>
<p><span style="font-weight: 400;">In FME Flow, navigate to the Jobs &gt; Completed page. Find the last submitted job by the workspace name and time of submission.</span></p>
<p><span style="font-weight: 400;"><img src="images/1724283431740.png" alt="View Completed Jobs" /></span></p>
<p><span style="font-weight: 400;">Select the job to review the log. Expand <strong>REQUEST DATA</strong> to find the parameters. </span></p>
<p><span style="font-weight: 400;"><img src="images/1724283546573.png" alt="" /></span></p>
<p>Congratulations! You&rsquo;ve now ran a job , using multiple parameters, via Webhook URL.&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>