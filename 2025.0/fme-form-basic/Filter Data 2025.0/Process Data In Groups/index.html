<h2 id="learning-objectives">Learning Objectives</h2>
<p>After completing this lesson, you&rsquo;ll be able to:</p>
<ul>
<li>Explain how the Group By parameter lets you process features in groups.</li>
<li>Explain the difference between the Process at End and Process When Group Changes Group By modes.</li>
<li>Use the Group By parameter in an FME transformer.</li>
</ul>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/TransformAttributes/process-data-in-groups.fmw" target="_blank" rel="noopener">Starting workspace</a>
<ul>
<li>C:\FMEData\Workspaces\TransformAttributes\process-data-in-groups.fmw</li>
</ul>
</li>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/TransformAttributes/process-data-in-groups-complete.fmw" target="_blank" rel="noopener">Complete workspace</a>
<ul>
<li>C:\FMEData\Workspaces\TransformAttributes\process-data-in-groups-complete.fmw</li>
</ul>
</li>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Data/Parks.zip" target="_blank" rel="noreferrer noopener">Parks.zip</a>&nbsp;(MapInfo TAB)
<ul>
<li>C:\FMEData\Data\Parks\Parks.tab</li>
</ul>
</li>
</ul>
<h2 id="what-is-group-by">What is Group By?</h2>
<p>Group By parameters allow features to be processed in groups by a single FME transformer.</p>
<p>FME transformers perform transformations on either one feature at a time or a whole set of features at once.</p>
<ul>
<li>For example, the&nbsp;AreaCalculator&nbsp;transformer operates on one feature at a time (to measure the area of a single polygon feature). We call it a&nbsp;<strong>feature-based transformer</strong>.</li>
<li>The&nbsp;StatisticsCalculator operates on multiple features simultaneously (to calculate an average value for them all). In FME, we call this set of features a <strong>group</strong> and the transformer a <strong>group-based transformer</strong>.</li>
</ul>
<h2 id="creating-groups">Creating Groups</h2>
<p>A group is a defined set of features processed by a transformer. By default, group-based transformers treat all the features they receive as a single group.</p>
<p>However, such transformers also have a&nbsp;<strong>Group By</strong> parameter. This parameter lets the user define several groups based on an attribute's value.</p>
<blockquote>
<p><img class="img mtm" role="presentation" src="images/safe_note.png" alt="Note" /></p>
<p><span style="font-family: inherit; font-size: 1em;">To illustrate groups, let's consider calculating the mean age of FME users. The default group for the calculation includes </span><strong style="font-family: inherit; font-size: 1em;">all</strong><span style="font-family: inherit; font-size: 1em;"> FME users.</span></p>
<p><span style="font-family: inherit; font-size: 1em;">But you could instead divide everyone by their nationality and calculate the average age per country.</span></p>
<p><span style="font-family: inherit; font-size: 1em;">This is the same as having a nationality attribute in a dataset and selecting that in an FME Group By parameter.</span></p>
</blockquote>
<p>Here, a Dissolver transformer is used to dissolve (merge) several polygon features. The selected Group By attribute is <em>ViewDescription</em>. Additionally, you can set Complete Groups to When All Features Received, which makes the Dissolver a blocking transformer, or to When Group Changes (Advanced). The latter option should only be used when your data is sorted by the value(s) of the grouping attribute(s). It can offer a performance boost if your data is already sorted or if you are processing many records.</p>
<p><img class="image" src="images/1714081712903.png" alt="Setting a Group By parameter" width="784" height="193" /></p>
<p>FME creates a series of groups for overlaying, where the features in each group share the same value for the&nbsp;<em>ViewDescription</em>&nbsp;attribute. The practical outcome is that polygon dissolving takes place only where line features share the same description:</p>
<p><img class="image" src="images/1699305001209.png" alt="Example of results of using a Dissolver on geometry" width="610" height="350" /></p>
<h2 id="group-by-mode">Group By Mode</h2>
<p>When grouping features, the transformer can handle the group in two different ways. The first way is to hold all of the features until all of the features have come through the transformer; this is referred to as blocking. This is set using the Process at End (Blocking) Group By Mode.</p>
<p>The other way is to pre-sort your data into groups using a transformer like the Sorter. Then, once your data is grouped, use the Process When Group Changes (Advanced) Group By Mode. This mode will push the features through the transformer after each group, which will help speed up performance. Only use this option when your data is pre-sorted.</p>
<h2 id="exercise">Exercise</h2>
<p>Sven continues to work with the city park data. He's been asked to add the average size of parks in each neighborhood. To do this, he can use the Group By parameter with an existing workspace.</p>
<h2>1) Start FME Workbench</h2>
<p>Sven starts FME Workbench (2025.0.1 or later) and opens the <a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/TransformAttributes/process-data-in-groups.fmw" target="_blank" rel="noopener">starting workspace</a> (C:\FMEData\Workspaces\TransformAttributes\process-data-in-groups.fmw). This workspace calculates the average area of parks in the Downtown neighborhood using the StatisticsCalculator.</p>
<p><img class="image image-block" src="images/1753902698406.png" alt="Starting workspace" width="1772" height="274" /></p>
<p>He views the average area by running the workspace and inspecting the AttributeRenamer's Output port. AverageParkArea is 10,494 m&sup2; for the Downtown neighborhood:</p>
<p><img class="image image-block" src="images/1757091551803.png" alt="AverageParkArea in Table View" width="569" height="129" /></p>
<blockquote>
<p><img src="images/safe_note.png" alt="Note" /></p>
<p>Remember that you can view the units for area or length calculations by checking the coordinate system of your data using the Feature Information Window. See <a href="https://academy.safe.com/connect-to-data" target="_blank" rel="noopener">Connect to Data</a> for more details.</p>
</blockquote>
<h2>2) Set Group By in the StatisticsCalculator</h2>
<p>Now he'd like to change the workspace to calculate the park area by neighborhood. He views the parameters for the StatisticsCalculator transformer. He checks Group Processing and clicks the '...' button beside the Group By parameter. He selects the attribute called Neighborhood:</p>
<p><img class="image image-block" src="images/1714081908118.png" alt="Group By Neighborhood" width="666" height="484" /></p>
<p>He clicks OK/Apply to apply the changes to the transformer.</p>
<blockquote>
<p><img src="images/safe_note.png" alt="Note" /></p>
<p>Older versions of FME had a Cumulative output port for the StatisticsCalculator. If you wish to calculate a cumulative or running statistic that is updated for each feature, check Advanced&mdash;Output Cumulative Results. This method can be helpful to determine when a cumulative sum, count, or mean surpasses a particular threshold value. In that case, you would need to combine the output of the StatisticsCalculator Cumulative port with a filtering transformer like a Tester.</p>
</blockquote>
<h2>3) Run the Workspace</h2>
<p>He clicks on the StatisticsCalculator and then clicks on Run To This. He inspects the Summary output port in Visual Preview, which creates a summarized table of the statistics he is calculating.</p>
<p>This table displays the value of ParkArea.mean for each neighborhood. However, because there is only one neighborhood included in the dataset after the AttributeFilter, Sven sees that there is only one feature in the Summary table:</p>
<p><img src="images/1745527216289.png" alt="Summary port" /></p>
<h2>4) Add Another Neighborhood</h2>
<p>Sven decides to include the Fairview neighborhood in the written data as well. He connects the Fairview output port on the AttributeFilter to the AreaCalculator.</p>
<p>He uses Run To This on the StatisticsCalculator again, and now the Summary port shows the average park area for both neighborhoods:</p>
<p><img src="images/1745527473018.png" alt="Summary port" /></p>