<h2 id="learning-objectives">Learning Objectives</h2>
<p>After completing this lesson, you&rsquo;ll be able to:</p>
<ul>
<li>Explain the benefits of using job chaining.</li>
<li>Use the Filter Action to conditionally trigger a workspace to run.</li>
<li>Chain multiple workspaces together in an Automation.</li>
</ul>
<h2 id="resources">Resources</h2>
<ul>
<ul>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/AutomateWorkflowsWithFMEFlow/automate-workflows-with-fme-flow--starting-project.fsproject">Starting project</a>&nbsp;| C:\FMEData\Workspaces\AutomateWorkflowsWithFMEFlow\automate-workflows-with-fme-flow--starting-project.fsproject</li>
<li><a href="https://s3.amazonaws.com/FMEData/FMEData/Data/Elections/ElectionVoting.gml" target="_blank" rel="noreferrer noopener">ElectionVoting.gml</a> | C:\FMEData\Data\Elections\ElectionVoting.gml</li>
</ul>
</ul>
<p>If you're taking a live Safe Software-hosted training course or using an on-demand lab for this course, we've already imported the content for this lesson into your FME Flow.<br />If you're completing this lesson with your own FME Flow, you must import the starting project with the content into your FME Flow.&nbsp;</p>
<ul>
<ul><!-- BEGIN: Reusable Custom Expandable Section --></ul>
</ul>
<div>
<style>
  .custom-details {
    background-color: #07D7FF; /* safe blue */
    color: #333;
    padding: 14px;
    margin-bottom: 10px;
    border-radius: 4px;
    cursor: pointer;
  }

  .custom-details summary {
    font-size: 18px;
    font-weight: bold;
    outline: none;
    user-select: none;
    padding: 5px 0;
  }

  .custom-details[open] {
    background-color: #d3d3d3; /* grey */
  }

  .custom-details div {
    padding-top: 10px;
    padding-bottom: 10px;
    padding-left: 12px;
    margin-top: 10px;
    font-size: 16px;
    line-height: 1.5;
  }
</style>
</div>
<details class="custom-details">
<summary>Expand for Steps to Import the Starting Project</summary>
<div>1) Download the <a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/AutomateWorkflowsWithFMEFlow/automate-workflows-with-fme-flow--starting-project.fsproject" target="_blank" rel="noopener">starting project</a> and the<a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/AutomateWorkflowsWithFMEFlow/automate_workflows_with_fme_flow.jceks" target="_blank" rel="noopener"> encryption key</a>.</div>
<div>2) Upload the <a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/AutomateWorkflowsWithFMEFlow/automate_workflows_with_fme_flow.jceks" target="_blank" rel="noopener">automate_workflows_with_fme_flow.jceks</a> encryption key to your FME Flow. This must be done by an fmesuperuser who has permission to System Configuration &gt; Security &gt; System Encryption. For more information, see our documentation on <a href="https://docs.safe.com/fme/html/FME-Flow/WebUI/Encryption.htm" target="_blank" rel="noopener">System Encryption</a>.</div>
<div>3) Navigate to your FME Flow and open Projects. Click Import.&nbsp;</div>
<div><img src="images/1748467877735.jpg" alt="" width="979" height="302" /></div>
<div>4) Upload automate-workflows-with-fme-flow--starting-project.fsproject as the Project File and then click Import.&nbsp;</div>
<div><img src="images/1754602691120.jpg" alt="" /></div>
<div>5) The first step is Preview Content, where you may choose not to overwrite existing items. If all your items are New Items, you don't need to worry about overwriting existing items. Click Continue.</div>
<div><img src="images/1754602971975.jpg" alt="" /></div>
<div>6) The next step is to select connections and tokens to import. By default, they are not selected to be imported. <strong>Select the FME Training PostGIS Database Connection to import.</strong> If it isn't imported, the workflows will not run successfully. Click Continue.&nbsp;</div>
<div><img src="images/1754602868434.jpg" alt="" /></div>
<div>7) The Resolve Owners step only allows you to reassign the project contents to a different user if the admin user doesn't exist on your FME Flow. Click Continue and then click Import Project from the Additional Options step. The project will import and display its import status from the same page.</div>
<div><img src="images/1748469576862.jpg" alt="" width="294" height="108" /></div>
<div>If the project import failed, check that you uploaded the encryption key and repeat the process. If it still fails, contact us at train@safe.com.&nbsp;</div>
</details><!-- The script tag should live in the head of your page if at all possible -->
<p>
<script type="text/javascript" src="https://play.vidyard.com/embed/v4.js"></script>
</p>
<!-- Put this wherever you would like your player to appear -->
<h2 id="job-chains-and-automations">Job Chaining and Automations</h2>
<p>In your workflows, you may want to run multiple workspaces and control their order. With FME Flow Automations, you can chain your workspaces to run one after another in sequence, or you may branch the workflow to run multiple workspaces simultaneously. You may also use logic to control your workflow based on a condition. FME Flow Automations are flexible, letting you place internal and external actions in any sequential order or parallel streams, so you can adapt an Automation however you may need.&nbsp;</p>
<p>An advantage of authoring workspaces to run in sequence is compartmentalizing your workflows. Separating tasks into workspaces makes it easier to see where errors occur, and you can run other workspaces or send notifications if a workspace fails. If the inputs and outputs of the workspaces are independent, you may run the workspaces in parallel, whereby a failure in one workspace does not stop the other workspace from running.&nbsp;</p>
<p><img src="images/1754489966068.jpg" alt="" width="792" height="411" /></p>
<h3 id="run-jobs-in-sequence">Run Jobs in Sequence</h3>
<p>To run actions in sequence, connect them one after the other.&nbsp;</p>
<p><a href="https://s3.amazonaws.com/gitbook/Server-Authoring-2020/ServerAuthoring4RealTime/Images/Img6.019.Sequence.png" target="_blank" rel="noreferrer noopener"><img src="images/1754490052615.jpg" alt="" /></a></p>
<p>In this example, Workspace B will only run after Workspace A runs and completes successfully. If Workspace A fails, Workspace B will not run. FME Flow will only use one engine in this example because only one translation is being processed at a time.&nbsp;</p>
<p>You should run jobs in sequence if the source data for a workspace depends on the output data from another workspace, your workflow requires tasks to be completed in order, or specific tasks should only be carried out if another task completes successfully.&nbsp;</p>
<h3 id="run-jobs-in-parallel">Run Jobs in Parallel</h3>
<p>Connect actions to a common starting point to run them in parallel. When FME Flow passes a message to one action, it will also pass a message to the other action and process them simultaneously. The common starting point can be a trigger or another action.&nbsp;</p>
<p><a href="https://s3.amazonaws.com/gitbook/Server-Authoring-2020/ServerAuthoring4RealTime/Images/Img6.020.Parallel.png" target="_blank" rel="noreferrer noopener"><img src="images/1754490602354.jpg" alt="" /></a></p>
<p>In this example, the incoming message is sent to Workspace A and Workspace B simultaneously. As long as FME Flow has multiple engines available, the workspaces will run simultaneously and independently of each other. If only one FME Flow engine is available, one workspace will run to completion, and the second will run after. There's no guarantee which workspace will run first unless you have some advanced <a href="https://docs.safe.com/fme/html/FME-Flow/WebUI/Engine-Management.htm">Engine Management</a> rules set up.&nbsp;</p>
<p>You should run actions in parallel if you have multiple tasks to complete in response to the same input, either a trigger or action, and the workspaces are independent, meaning they do not depend on datasets from one another, nor the success or failure of each other.&nbsp;</p>
<h2 id="conditional-processing">Conditional Processing</h2>
<p>Conditional processing in Automations involves running workspaces or actions depending on a previous event or condition.&nbsp;</p>
<p>You can use the Filter Messages action in Automations to test simple Boolean conditions, evaluating them as true or false. The Filter action can filter on values from previous actions within the Automation.</p>
<blockquote>
<p><strong><img class="img mtm" role="presentation" src="images/safe_note.png" alt="Note" /></strong></p>
<p>To use the Filter on data within a workspace, you must use an Automations Writer to pass the data from the workspace to the Automation. We will cover the Automations Writer later in this course.&nbsp;</p>
</blockquote>
<p>The Filter Messages action has success and failure ports to route messages depending on whether the condition is true or false.&nbsp;</p>
<p><img src="images/1754499945735.jpg" alt="" /></p>
<p>In this example, Workspace A runs if the Filter condition evaluates to true, and Workspace B runs if the condition is false. In a single run of the Automation, only Workspace A or Workspace B runs, not both.&nbsp;</p>
<p>The Filter action in Automations is somewhat limited in that it only supports simple conditions. You can use a Run a Workspace action with an Automations Writer to route data to various ports for more advanced filtering. You'll learn more about the Automations Writer later in this course.&nbsp;</p>
<p><img src="images/1754594390842.jpg" alt="" /></p>
<p>You may also wish to carry out certain translations in the unfortunate case that a job fails. To run a workspace in case of a workspace failure, you can attach Run a Workspace actions to the previous action failure port.&nbsp;</p>
<p><img src="images/1754494442507.jpg" alt="" /></p>
<p>In this example, Workspace B runs if Workspace A succeeds, while Workspace C runs if Workspace A fails.</p>
<div class="box message info">
<div class="inner">
<div class="bd">
<div class="media"><span style="font-size: 2.3125em;">Exercise</span></div>
</div>
</div>
</div>
<p><img src="images/1754409855160.png" alt="" width="273" height="290" /></p>
<p>Sven, a planning analyst, is building an Automation to update election voting location information. He has two workspaces: one that updates a SpatiaLite database with electoral divisions and voting places, and another that assigns voting division IDs to addresses. He runs these workspaces consecutively, in order, as the second workspace relies on data updates from the first workspace.&nbsp;</p>
<p>Since election data does not change often, nor do elections occur frequently, Sven usually forgets to update the database manually. So, Sven will create an Automation with a Schedule trigger to run his workspaces in sequence and update the data yearly. The Schedule trigger also allows him to trigger the Automation manually if he needs to update the data for a specific event.&nbsp;</p>
<p>Follow along with Sven as he builds his Automation, which chains his workspaces sequentially.&nbsp;</p>
<h3>1) Create Automation</h3>
<p>Sven opens FME Flow and selects Create Automation in the side menu. If the Get Started window appears, he selects Create New...</p>
<p><img src="images/1754410711324.jpg" alt="" width="1202" height="544" /></p>
<blockquote>
<p><strong><img class="img mtm" role="presentation" src="images/safe_note.png" alt="Note" /></strong></p>
<p>Your Automation may have the Next Action guides enabled. To remove them, expand the Automations Menu and select Hide Guides.&nbsp;</p>
</blockquote>
<h3>2) Add Schedule Trigger</h3>
<p>Sven opens the trigger details and selects an FME Flow Schedule (initiated) trigger. He leaves the Schedule Type as Basic and sets the Recurrence to Yearly on&nbsp;<em>Today's Date</em>. He ensures Does Not Expire is checked and clicks Apply.&nbsp;</p>
<p><img src="images/1754411025257.jpg" alt="" width="434" height="700" /></p>
<h3>3) Add Run a Workspace Actions</h3>
<p>Sven adds a Run a Workspace action to the trigger's success port and sets it to run the update-voting-places.fmw workspace in the Elections repository. The workspace has no parameters to configure, so Sven clicks Apply to save and close the action details.&nbsp;</p>
<p><img src="images/1754411299348.jpg" alt="" width="808" height="569" /></p>
<p>Sven adds another Run a Workspace action to the update-voting-places action and sets it to run the divide-addresses-by-voting-division.fmw workspace. Again, the workspace has no configurable parameters, so Sven clicks Apply.&nbsp;</p>
<p><img src="images/1754411440390.jpg" alt="" width="989" height="656" /></p>
<h3>3) Add Email Action</h3>
<p>Sven adds an External Action to the second workspace's success port. He will send himself an alert each time the Automation successfully completes.&nbsp;</p>
<p><img src="images/1754411735092.jpg" alt="" /></p>
<p>Sven opens the External Actions Details and selects the Email (send) action.&nbsp;</p>
<p><img src="images/1754063778382.jpg" alt="" width="568" height="382" /></p>
<p>Sven will configure the action to use a Gmail account, so he selects Gmail using the Load Template option and pre-populates some of the SMTP parameters.</p>
<p><img src="images/1754063938269.jpg" alt="" /></p>
<p>Sven enters these values for the SMTP parameters:</p>
<ul>
<li>SMTP Account:&nbsp;<strong>training.fmeflow@gmail.com</strong></li>
<li>SMTP Password:&nbsp;<strong>wjdmzjdkujkzmplw&nbsp;</strong></li>
<li>Connection Security:&nbsp;<strong>SSL/TLS</strong></li>
</ul>
<blockquote>
<p><strong><img class="img mtm" role="presentation" src="images/safe_note.png" alt="Note" /></strong></p>
<p>This Gmail account password changes regularly. Please only use it for FME training purposes, or configure your SMTP account for the Email action.&nbsp;</p>
</blockquote>
<p>Sven enters his email for the Email To parameter and uses training.fmeflow@gmail.com for the Email From parameter.&nbsp;</p>
<p>Sven uses the drop-down arrow for the Email Subject to select the Automation Name.&nbsp;</p>
<p><img src="images/1754412385576.jpg" alt="" /></p>
<p>For the Email Body, he uses the drop-down to select the Text Editor.&nbsp;He configures a message to send to himself using attributes on the left to customize it. He clicks Save to close the Text Editor.</p>
<p><img src="images/1754412547532.jpg" alt="" /></p>
<p>Once Sven fills out all the required parameters, Sven clicks Validate.&nbsp;</p>
<p><img src="images/1754412728684.jpg" alt="" /></p>
<p>Sven must scroll to the top of the Parameters section to see the validation result. If all his parameters are valid, Sven clicks Apply.&nbsp;</p>
<p><img src="images/1754412808056.jpg" alt="" /></p>
<h3 id="6-save-and-start-automation">5) Start and Trigger Automation</h3>
<p>Sven saves his Automation as Election Location Update and clicks Start to run his Automation.&nbsp;</p>
<p><img src="images/1754412958818.jpg" alt="" /></p>
<p>The Automation will run only on the scheduled date and time, so Sven will trigger it manually to test it. He opens the FME Flow Schedule Details and clicks Trigger.</p>
<p><img src="images/1754413119335.jpg" alt="" width="1265" height="662" /></p>
<h3 id="7-test-the-automation">6) Check Jobs</h3>
<p>Sven opens the Automations Menu and clicks View Triggered Jobs.</p>
<p><img src="images/1754414703226.jpg" alt="" /></p>
<p>Both workspaces ran, and Sven saw that the second workspace did not begin to process until the first workspace was finished. Sven expects this as he wants the addresses to update with the newest voting division data from the first workspace.</p>
<p><img src="images/1754415246047.jpg" alt="" /></p>
<p>Sven also received an email that he configured with the Email external action.&nbsp;</p>
<p><img src="images/1754417307698.jpg" alt="" width="741" height="172" /></p>
<p>Sven now has multiple jobs chained in an Automation, ensuring one job does not begin to process until after another job completes. He also sent himself an email to notify himself when the Automation processes.&nbsp;</p>