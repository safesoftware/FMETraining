<h2 id="learning-objectives">
  <span>Learning Objectives</span>
</h2>
<p>After completing this lesson, you’ll be able to:</p>
<ul>
  <li>Give users options when using self-serve applications.</li>
  <li>Configure a self-serve service with published parameters.</li>
</ul>
<h2 id="resources">
  <span>Resources</span>
</h2>
<ul>
  <li><a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/CreateDataIntegrationApps/exercise-create-a-user-controlled-workspace.fmw" rel="noreferrer noopener" target="_blank">Starting workspace</a></li>
  <li><a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/CreateDataIntegrationApps/exercise-create-a-user-controlled-workspace-complete.fmw" rel="noreferrer noopener" target="_blank">Complete workspace</a></li>
</ul>
<h2 id="introduction">
  <span>Introduction</span>
</h2>
<p>In a recent project, you had to compile a list of customers to notify that were affected by a water pump failure. After the list was compiled, the customers were manually notified. In anticipation of an event similar to this in the future, you would like to publish the workspace to FME Server to share with your colleagues, modify the workspace to accept an updated file, as well as automate it, so the workspace runs on a schedule.</p>
<p>In this exercise, you will create user parameters before publishing the workspace to FME Server. </p>
<h2 id="1-open-fme-workbench">
  <span>1) Open FME Workbench</span>
</h2>
<p>Open starting workspace in FME Workbench (2022.0 or later).</p>
<h2 id="2-open-the-generic-writer-published-parameters">
  <span>2) Open the Generic Writer Published Parameters</span>
</h2>
<p>Look at the Navigator window. This workspace uses a Generic writer, which can write to any FME-supported format. </p>
<p>In the Navigator window, expand the Generic writer by clicking the arrow to the left of it, then expand Parameters.</p>
<p><img src="images/1644016548652.png" class="image image-block image-center" alt="Finding the Output Format parameter in the Navigator" /></p>
<p>Currently, the default format is set to Esri Shapefile. But, the goal for this exercise is for the user to select the format of their choice from a small list, at run time. This step is accomplished with published parameters. </p>
<p>Double-click the Output Format parameter, which shows that it’s been set up so the user can select from any format.</p>
<p><img src="images/1644016651380.png" class="image image-block image-center" alt="Configuring the Output Format parameter" /></p>
<p>But that’s not what we want. The goal is to present the user with a list of four common formats. So, we will create a new user parameter and define it accordingly.</p>
<h2 id="3-create-new-user-parameter">
  <span>3) Create New User Parameter</span>
</h2>
<p>In the Navigator window, right-click on User Parameters and select Manage User Parameters.<img src="images/1644016673969.png" class="image image-block image-center" alt="Manage User Parameters" /><br /><br />Click on the Green plus sign then select Choice.<img src="images/1644016693614.png" class="image image-block image-center" alt="Adding a Choice parameter" /><br /><br />On the right-hand side fill in the following parameter properties:</p>
<table class="featureTable sort_table" style="width:100%">
  <tbody class="tbody">
    <tr>
      <td style="width:50.0000%"><strong>Parameter Identifier</strong><br /></td>
      <td style="width:50.0000%">Output_Format<br /></td>
    </tr>
    <tr>
      <td style="width:50.0000%"><strong>Prompt</strong><br /></td>
      <td style="width:50.0000%">Enter an output format:<br /></td>
    </tr>
    <tr>
      <td style="width:50.0000%"><strong>Published</strong><br /></td>
      <td style="width:50.0000%">Enabled<br /></td>
    </tr>
    <tr>
      <td style="width:50.0000%"><strong>Required</strong><br /></td>
      <td style="width:50.0000%">Disabled<br /></td>
    </tr>
    <tr>
      <td style="width:50.0000%"><strong>Disable Attribute Assignment:</strong><br /></td>
      <td style="width:50.0000%">Enabled<br /></td>
    </tr>
    <tr>
      <td style="width:50.0000%"><strong>Choice Configuration</strong><br /></td>
      <td style="width:50.0000%">Drop-down<br /></td>
    </tr>
  </tbody>
</table>
<p><br />Then for Choices enter the following:</p>
<table class="featureTable sort_table">
  <tbody class="tbody">
    <tr>
      <td colspan="1" rowspan="1"><strong>Value</strong></td>
      <td colspan="1" rowspan="1"><strong>Display</strong></td>
    </tr>
    <tr>
      <td colspan="1" rowspan="1">SHAPEFILE</td>
      <td colspan="1" rowspan="1">Esri Shapefile</td>
    </tr>
    <tr>
      <td colspan="1" rowspan="1">MITAB</td>
      <td colspan="1" rowspan="1">MapInfo TAB</td>
    </tr>
    <tr>
      <td colspan="1" rowspan="1">GML</td>
      <td colspan="1" rowspan="1">GML<br /></td>
    </tr>
  </tbody>
</table>
<p>Then select Esri Shapefile as the default value and click OK.<img src="images/1644016714784.png" class="image image-block image-center" alt="Configured Output Format parameter" /></p>
<div class="box message info">
  <div class="inner">
    <div class="bd">
      <div class="media">
        <img class="img mtm" role="presentation" src="https://safemytrailhead.s3.us-west-2.amazonaws.com/images/safe_note.png" alt="Note" />
        <div class="mediaBd">
          <div class="message-media-content">
            <p>In versions of FME other than 2021.0, you can use the Import button in the Choices table to automatically fill in the table with selected reader formats, writer formats, or coordinate systems.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<h2 id="4-link-published-parameter-to-output-format-parameter">
  <span>4) Link Published Parameter to Output Format Parameter</span>
</h2>
<p>Our new Output_Format parameter appears under User Parameters &gt; Published Parameters, but we still have to link it to the Generic Writer’s Output Format parameter. Locate the Output [GENERIC] Writer, and expand it with the arrow to view the Parameters, the first one being Output Format. Right-click on Output Format, select Link to User Parameter.</p>
<p><img src="images/1644016733898.png" class="image image-block image-center" alt="Linking Output Format to a User Parameter" /></p>
<p> </p>
<p>Select the new Output_Format parameter we just created.</p>
<p><img src="images/1644016754923.png" class="image image-block image-center" alt="Selecting a user parameter to link" /></p>
<p>Click OK.</p>
<h2 id="5-run-the-workspace">
  <span>5) Run the Workspace</span>
</h2>
<p>If you run the workspace immediately, it will use the default value and output an Esri Shapefile. However, if you select Prompt for User Parameters then click Run, you will be prompted to choose the output format. Notice only those three formats are presented now in the drop-down list. Pick GML. The workspace runs successfully.</p>
<p><img src="images/1644016774693.png" class="image image-block image-center" alt="Turning Prompt for User Parameters on" /></p>
<div class="box message info">
  <div class="inner">
    <div class="bd">
      <div class="media">
        <img class="img mtm" role="presentation" src="https://safemytrailhead.s3.us-west-2.amazonaws.com/images/safe_note.png" alt="Note" />
        <div class="mediaBd">
          <div class="message-media-content">
            <p>If you are using FME 2022.0, you might see that the Prompt for User Parameters dialog mentions an invalid parameter for the Geodatabase reader. You can ignore this, as the parameter is actually valid, and the workspace will run. This is a known issue.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<p> </p>
<h2 id="6-publish-features-types-to-read-parameter">
  <span>6) Publish Features Types to Read Parameter</span>
</h2>
<p>Now let’s set up the workspace so the user gets to choose which feature types they want to request.</p>
<p>In the Navigator, expand the CommunityMap [FILEGDB] File Geodatabase Reader &gt; Parameters &gt; and double click Features to Read. This parameter lets the user decide which feature types to process when the workspace runs. Close the dialogue.</p>
<p><img src="images/1644016808640.png" class="image image-block image-center" alt="Finding the Feature Types to Read parameter in the Navigator" /></p>
<p> </p>
<p>Right-click on Feature Types to Read parameter and select Create User Parameter. Go with the defaults for the definition, and click OK. Confirm the new parameter appears under Published Parameters.</p>
<p><img src="images/1644016828680.png" class="image image-block image-center" alt="Viewing the Feature Types to Read parameter" /></p>
<p> </p>
<h2 id="7-run-workspace-again">
  <span>7) Run Workspace Again</span>
</h2>
<p>Ensure that Prompt for User Parameters is still enabled and rerun the workspace.</p>
<div class="box message info">
  <div class="inner">
    <div class="bd">
      <div class="media">
        <img class="img mtm" role="presentation" src="https://safemytrailhead.s3.us-west-2.amazonaws.com/images/safe_note.png" alt="Note" />
        <div class="mediaBd">
          <div class="message-media-content">
            <p>Remember to use <strong>Run &gt; Rerun Entire Workspace </strong>after you change user parameters. FME will only prompt you to choose parameter values for parts of the workspace that run, so it's best to run the entire workspace to make sure you are prompted.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<p>Notice that this time there are two parameters to set. Set it to whatever parameters you wish, and then click Run. Confirm that the workspace runs correctly.</p>
<p><img src="images/1644016921060.png" class="image image-block image-center" alt="Selecting user parameter values" /></p>
<p> </p>
<h2 id="8-publish-to-fme-server">
  <span>8) Publish to FME Server</span>
</h2>
<p>Now that we have the parameters set up and confirmed that the workspace runs correctly, we can publish it to FME Server. </p>
<p>Before publishing, save the workspace. Once saved, go to File &gt; Publish to FME Server on the top menu bar.</p>
<p>Connect to your FME Server and publish to a repository called Training. Call the workspace CommunityMapping.fmw. Register it with the Data Download and Job Submitter services. </p>
<h2 id="9-open-the-fme-server-web-user-interface">
  <span>9) Open the FME Server Web User Interface</span>
</h2>
<p>Open and log into the FME Server Web User Interface.</p>
<h2 id="10-run-workspace">
  <span>10) Run Workspace</span>
</h2>
<p>On the side menu bar in FME Server, click on Run Workspace. On the Run Workspace page, select Training for the Repository and the CommunityMapping workspace. Select Data Download for the Service.</p>
<p>Check out the Published Parameters. The two parameters that were set up and just tested in FME Workbench are shown. Just as before, select an output format, and select one or more feature types.</p>
<p><img src="images/1654891014437.png" class="image image-block image-center" alt="Selecting one feature type" /></p>
<p> </p>
<p>Once you have selected the parameters, click Run.</p>
<h2 id="11-view-the-results">
  <span>11) View the Results</span>
</h2>
<p>The Data Download service presents a URL link to the translation results in a zip file. A quick inspection of the contents of the zip file confirms the results are what we expected.</p>