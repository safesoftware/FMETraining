<h2 id="learning-objectives">
  <span>Learning Objectives</span>
</h2>
<p>After completing this lesson, you’ll be able to:</p>
<ul>
  <li>Explain how FME Server Automations can save time.</li>
  <li>Create an Automation to run a workspace on a schedule.</li>
  <li>See the other Automation options available.</li>
</ul>
<h2 id="resources">
  <span>Resources</span>
</h2>
<ul>
  <li><a href="http://ior.ad/6Xi6" rel="noreferrer noopener" target="_blank">Interactive tutorial to help you follow along</a></li>
  <li><a href="https://s3.amazonaws.com/FMEData/FMEData/Workspaces/IntegrateDataWithTheFMEPlatform/publish-your-self-serve-workspace.fmw" rel="noreferrer noopener" target="_blank">Starting workspace</a> (should already be published to FME Server as per the previous lesson’s instructions)</li>
</ul>
<h2 id="video">
  <span>Video</span>
</h2>
<p><span><iframe width="640" height="360" src="https://play.vidyard.com/xrTfPQTq9cbvjStCvjSDyk?" allowfullscreen title="Video Content" class="image-center"></iframe></span></p>
<h2 id="automate-your-use-of-fme-server">
  <span>Automate Your Use of FME Server</span>
</h2>
<p>Fatima tells Frank that she would like to receive an email with an Excel report of all the food vendors once a month. Frank offers to use <a href="https://docs.safe.com/fme/html/FME_Server_Documentation/WebUI/Automations-General/Automations.htm" rel="noreferrer noopener" target="_blank">FME Server </a><a href="https://docs.safe.com/fme/html/FME_Server_Documentation/WebUI/Automations-General/Automations.htm" rel="noreferrer noopener" target="_blank">Automations</a> to create that workflow for her.</p>
<p>Automations takes data integration to the next level. Designing your FME workspaces with this in mind lets you create reusable, modular, and integrated applications for your organization, rather than one-off, single-use workspaces for every workflow. Automations support automated schedules and event-driven workflows that can:</p>
<ul>
  <li>Eliminate manual intervention.</li>
  <li>Remove schedule-based delays.</li>
  <li>Ensure data is always current and available.</li>
</ul>
<p>Automations let you implement the <a href="https://www.safe.com/blog/2020/03/fme-server-2020-enterprise-integration-patterns/" rel="noreferrer noopener" target="_blank"><strong>enterprise integration patterns</strong></a><strong> </strong>popularized by <a href="https://www.enterpriseintegrationpatterns.com/" rel="noreferrer noopener" target="_blank">Gregor Hohpe and Bobby Woolf</a>: repeatable solutions to commonly occurring problems encountered when integrating applications or systems.</p>
<h2 id="create-an-automation-triggered-on-a-schedule">
  <span>Create an Automation Triggered on a Schedule</span>
</h2>
<p>Frank needs to create a new Automation to run his self-serve workspace once a month and send the results as an Excel file to Fatima.</p>
<p>He logs into FME Server (2022.0 or later) and clicks<strong> Automations &gt; Build Automation </strong>in the web interface menu on the left side of the window.</p>
<p><img src="images/1651788657534.png" class="image image-block image-center" alt="Build Automations menu option" /></p>
<p>Because he has built Automations before, he clicks <strong>Close </strong>when the <strong>Get Started </strong>window appears.</p>
<p><img src="images/1651788730244.png" class="image image-block image-center" alt="Closing Get Started popup" /></p>
<p>Frank knows all Automations are composed of three objects:</p>
<ul>
  <li><strong>Triggers </strong>listen for and receive messages from an external client or from within FME Server. Every Automation begins with a Trigger.</li>
  <li><strong>Actions </strong>process messages between triggers and external actions, either in an FME workspace or through another tool.</li>
  <li><strong>External Actions </strong>send a message to an external client or another process in FME Server. What happens afterward is no longer part of this Automation.</li>
</ul>
<p>A green <strong>Trigger </strong>is already on the canvas. He double-clicks the <strong>Trigger </strong>to open the <strong>Trigger Details </strong>pane.</p>
<p><img src="images/1651858166306.png" class="image image-block image-center" alt="Selecting a Trigger to edit" /></p>
<p>He clicks the <strong>Trigger </strong>drop-down and scrolls down to select <strong>FME Server Schedule (initiated)</strong>.</p>
<p><img src="images/1651788841876.png" class="image image-block image-center" alt="FME Server Schedule initiated" /></p>
<div class="box message info">
  <div class="inner">
    <div class="bd">
      <div class="media">
        <img class="img mtm" role="presentation" src="https://safemytrailhead.s3.us-west-2.amazonaws.com/images/safe_note.png" alt="Note" />
        <div class="mediaBd">
          <div class="message-media-content">
            <p>You can trigger Automations from a variety of sources, including cloud services, email, file directories, or webhooks.</p>
            <p><a href="https://docs.safe.com/fme/html/FME_Server_Documentation/WebUI/Automations-General/Automations-Triggers.htm" rel="noreferrer noopener" target="_blank">Learn More</a></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<p>Frank notes that FME Server Schedules are representative of the time zone where FME Server was installed. He sets up a <strong>Basic</strong> <strong>Schedule </strong>with the <strong>Start </strong>date as the last day of the current month and <strong>Recurrence </strong>as <strong>Last day of every month</strong>. <img src="images/1651788975484.png" class="image image-block image-center" alt="Creating a Basic Schedule to recur on the last day of every month" /></p>
<p>He clicks <strong>Apply</strong> and the <strong>Trigger </strong>changes to a <strong>Schedule </strong>to show it’s been set.</p>
<p><img src="images/1651789026462.png" class="image image-block image-center" alt="Schedule on canvas" /></p>
<p>Then he clicks <strong>Menu &gt; Save As</strong>.</p>
<p><img src="images/1651789211048.png" class="image image-block image-center" alt="Menu &gt; Save As" /></p>
<p>He names the Automation “Monthly Food Vendor Update” and clicks <strong>OK</strong>.</p>
<p><img src="images/1651789348881.png" class="image image-block image-center" alt="Saving Automation" /></p>
<h2 id="run-a-workspace-in-response-to-a-trigger">
  <span>Run a Workspace in Response to a Trigger</span>
</h2>
<p>Now that he’s set a <strong>Trigger</strong>, he needs to add an <strong>Action </strong>that will occur when the trigger is activated.</p>
<p>He clicks on the empty circle icon above <strong>Next Action</strong> to open the <strong>Next Action Details</strong> pane. Then he selects <strong>Run a Workspace </strong>from the drop-down options.</p>
<p><img src="images/1651789405154.png" class="image image-block image-center" alt="Clicking Next Action" /></p>
<p><img src="images/1651789455654.png" class="image image-block image-center" alt="Selecting Run a Workspace as the Action" /></p>
<div class="box message info">
  <div class="inner">
    <div class="bd">
      <div class="media">
        <img class="img mtm" role="presentation" src="https://safemytrailhead.s3.us-west-2.amazonaws.com/images/safe_note.png" alt="Note" />
        <div class="mediaBd">
          <div class="message-media-content">
            <p>Other <strong>Actions </strong>include:</p>
            <ul>
              <li><strong>Merge Messages </strong>lets you combine the results of previous actions, such as the results from two separate workspaces.<ul>
                  <li style="margin-left:20px"><strong>Filter </strong>lets you conduct tests from previous triggers or actions to control how your Automation runs. It’s like a <a href="https://docs.safe.com/fme/html/FME_Desktop_Documentation/FME_Transformers/Transformers/tester.htm" rel="noreferrer noopener" target="_blank">Tester transformer</a> for Automations.</li>
                  <li style="margin-left:20px"><strong>Log </strong>lets you add to the Automations logs for workflow reporting and debugging.</li>
                </ul>
              </li>
            </ul>
            <p style="margin-left:60px"><a href="https://docs.safe.com/fme/html/FME_Server_Documentation/WebUI/Automations-General/Automations-Actions.htm" rel="noreferrer noopener" target="_blank">Learn More</a></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<p>He will set the Automation to run the self-serve workspace. He clicks <strong>Repository </strong>and chooses <strong>Self-Serve</strong>, then for <strong>Workspace </strong>chooses <strong>CommunityMapping.fmw</strong>.</p>
<p>Next, he fills in the <strong>Parameters</strong>, choosing "Excel" for the <strong>Output Format </strong>and selecting "FoodVendors" from <strong>Feature Types to Read</strong>. With the <strong>Parameters </strong>filled in, he clicks <strong>Apply</strong>.</p>
<p><img src="images/1651789536161.png" class="image image-block image-center" alt="Filling out Run a Workspace details" /></p>
<p>After clicking <strong>Apply</strong>, two new options appear on the canvas: a <strong>Next Action </strong>option for each port of the <strong>CommunityMapping.fmw </strong>workspace. The <strong>✔ (check) port </strong>action will occur if the workspace runs successfully, and the <strong>X port </strong>action will occur if the workspace fails. These branching options let you create robust Automations that account for failure.</p>
<p><img src="images/1651789561363.png" class="image image-block image-center" alt="Action added" /></p>
<h2 id="send-an-email-with-the-results-of-a-workspace">
  <span>Send an Email with the Results of a Workspace</span>
</h2>
<p>Frank clicks the <strong>Next Action </strong>option coming out of the success port at the top and chooses <strong>Email (send) </strong>for the <strong>Action</strong>. He fills in the email account information for his own company Gmail address, using the Gmail template provided via <strong>Load Template</strong>.</p>
<div class="box message info">
  <div class="inner">
    <div class="bd">
      <div class="media">
        <img class="img mtm" role="presentation" src="https://safemytrailhead.s3.us-west-2.amazonaws.com/images/safe_note.png" alt="Note" />
        <div class="mediaBd">
          <div class="message-media-content">
            <p style="margin-left:60px">If you are using Gmail or other email services requiring two-factor authentication, you will have to create an app password to allow FME Server access to your account. Use this instead of your normal password. For Gmail, see <a href="https://support.google.com/mail/answer/185833?hl=en" rel="noreferrer noopener" target="_blank">this tutorial</a>. If you don't want to set that up, you can just read along.</p>
            <p style="margin-left:60px">A large number of External Actions are also available, including integration with APIs, Amazon Web Services, Azure, Dropbox, FTP, JMS, and Websockets.</p>
            <p style="margin-left:60px"><a href="https://docs.safe.com/fme/html/FME_Server_Documentation/WebUI/Automations-General/Automations-External-Actions.htm" rel="noreferrer noopener" target="_blank">Learn More</a></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<p>For the <strong>Email To </strong>parameter, he types in Fatima’s email address, and for <strong>Email From</strong>, he enters his. For <strong>Email Subject</strong>, she enters “Monthly Food Vendor Report”. For <strong>Email Body </strong>he enters:</p>
<p>“Hello Fatima,</p>
<p>Please find the most up-to-date Food Vendor data attached.</p>
<p>Best, Frank”</p>
<p>Finally, he needs to attach the data created by the workspace. For <strong>Attachment </strong>he enters the same path used for <strong>Output Location </strong>when the workspace runs, “$(FME_SHAREDRESOURCE_DATA)/CommunityMapping.zip”.</p>
<p>To test the email server connection, he clicks <strong>Validate</strong>. After a moment, an alert reporting the connection is <strong>Valid </strong>appears at the top of the pane. Seeing that it works, he clicks <strong>Apply</strong>.</p>
<p>His Automation is complete! He clicks the icon in the toolbar to save his Automation.</p>
<p><img alt="Automation Save button" src="images/18-d-2-d-74-a-8727-4-dac-a-410-06217-c-71242-d.png" class="image image-block image-center" /></p>
<p>Then he clicks <strong>Start Automation </strong>in the top-right corner of the window.</p>
<p><img src="images/1651789620547.png" class="image image-block image-center" alt="Start Automation button" /></p>
<p>The Automation starts. To test it (as it won’t run for a while), he clicks the clock icon on the <strong>Schedule </strong>trigger to open its parameters. There is a new button: <strong>Trigger</strong>. This button is available once an Automation is running and lets you test it by immediately running it once. He clicks <strong>Trigger </strong>to run the Automation once right now.</p>
<p><img src="images/1651789672682.png" class="image image-block image-center" alt="Manually triggering an Automation" /></p>
<p>Fatima tells Frank she received an email: it worked. One less manual task for Fatima to do thanks to FME!</p>
<div class="box message info">
  <div class="inner">
    <div class="bd">
      <div class="media">
        <img class="img mtm" role="presentation" src="https://safemytrailhead.s3.us-west-2.amazonaws.com/images/safe_note.png" alt="Note" />
        <div class="mediaBd">
          <div class="message-media-content">
            <p style="margin-left:60px">This Automation is very tailored to Fatima’s workflow. Frank could improve it if Fatima’s needs change. For example, he could create a parameter that controls if all the data is written (the current behavior), or just the data updated in the last month. He could also create a User Key to pass the output location path to the Email action instead of manually entering it in two places. He could even start building the <a href="https://docs.safe.com/fme/html/FME_Desktop_Documentation/FME_ReadersWriters/automations/automations.htm" rel="noreferrer noopener" target="_blank">FME Automations writer</a> directly into his workspaces, creating modular pieces that fit into <a href="https://www.safe.com/blog/2020/03/fme-server-2020-enterprise-integration-patterns/" rel="noreferrer noopener" target="_blank">enterprise integration patterns</a>.</p>
            <p style="margin-left:60px"><a href="https://knowledge.safe.com/articles/92106/send-email-from-automations.html?" rel="noreferrer noopener" target="_blank">Learn More</a></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<h2 id="exercise">
  <span>Exercise</span>
</h2>
<p>Create an Automation like Frank’s. </p>
<p>If you wish, you can use your own email account for the <strong>Email (send) External Action</strong>, using one of the provided templates if appropriate. Instead of sending the report to Marcie, send an email to an account you monitor. </p>
<p>If you don't want to use email, you can simply use the <strong>Log a message A</strong><strong>ction </strong>instead. Use <strong>Menu &gt; View Log File </strong>from the page with your running Automation to test if it's working.</p>