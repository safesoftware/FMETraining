<!--Exercise Section-->


<table style="border-spacing: 0px;border-collapse: collapse;font-family:serif">
<tr>
<td width=25% style="vertical-align:middle;background-color:darkorange;border: 2px solid darkorange">
<i class="fa fa-cogs fa-lg fa-pull-left fa-fw" style="color:white;padding-right: 12px;vertical-align:text-top"></i>
<span style="color:white;font-size:x-large;font-weight: bold">Exercise 4</span>
</td>
<td style="border: 2px solid darkorange;background-color:darkorange;color:white">
<span style="color:white;font-size:x-large;font-weight: bold">The FME Data Inspector</span>
</td>
</tr>

<tr>
<td style="border: 1px solid darkorange; font-weight: bold">Data</td>
<td style="border: 1px solid darkorange">Zoning Data (GeoJSON)<br>Neighborhoods (Google KML)</td>
</tr>

<tr>
<td style="border: 1px solid darkorange; font-weight: bold">Overall Goal</td>
<td style="border: 1px solid darkorange">Set up dataset display</td>
</tr>

<tr>
<td style="border: 1px solid darkorange; font-weight: bold">Demonstrates</td>
<td style="border: 1px solid darkorange">Use of Display Control and Background Maps in the Data Inspector</td>
</tr>

<tr>
<td style="border: 1px solid darkorange; font-weight: bold">Start Workspace</td>
<td style="border: 1px solid darkorange">C:\FMEData2019\Workspaces\DesktopBasic\Basics-Ex4-Begin.fmw</td>
</tr>

<tr>
<td style="border: 1px solid darkorange; font-weight: bold">End Workspace</td>
<td style="border: 1px solid darkorange">C:\FMEData2019\Workspaces\DesktopBasic\Basics-Ex4-Complete.fmw </td>
</tr>

</table>


In the previous exercise, we inspected some data from a translation and added a second dataset. Now we can rearrange the data to make the display clearer.


<br>**1) Start FME Data Inspector**
<br>Continue in the FME Data Inspector from the previous exercise. You should have both the converted zones data (as GeoJSON) and a dataset of neighborhood boundaries in KML. The Display Control window looks like this:

![](./Images/Img1.219.Ex4.DisplayControlWindow.png)


<br>**2) Set Neighborhoods Symbology**
<br>The Display Control window shows a number of different layers in the VancouverNeighborhoods dataset. In reality, most of these are tabular (non-spatial) items. The layer we are interested in is called Neighborhoods.

Click the symbology icon for the Neighborhoods data in the Display Control window:

![](./Images/Img1.220.Ex4.SetSymbologyIcon.png)

Set the color to be a neutral shade (like orange) and increase the opacity value to 0.8:

![](./Images/Img1.221.Ex4.SetSymbologyDialog.png)


<br>**3) Set Draw Order**
<br>The previous change makes it clear that the zone features are below the neighborhoods in the drawing order. To solve this problem drag the Zones dataset above the VancouverNeighborhoods dataset in the Display Control Window.

At the same time set a color for the zones data fill color and reduce the opacity value to 0.1. The main view will now look like this:

![](./Images/Img1.222.Ex4.ResymbolizedData.png)

If you select a zone feature, you'll see that it has both a ZoneCategory and ZoneName attribute. You might not realize, but there is a relationship between those attributes. Each ZoneName belongs to a specific ZoneCategory, where Category:Name is a 1:Many relationship.

Let's clarify the display by merging all the features into one feature per ZoneCategory. We can do that in FME Workbench.


<br>**4) Return to Workspace**
<br>Return to FME Workbench. Open the workspace saved in Exercise 2, or the workspace listed above.

What we'll do here is use what we call a transformer. This object is something we'll cover in more detail in the chapter on Data Transformation. It is an object to transform data in some way.

Click on the dark line connecting the Reader Feature Type and Writer Feature Type. Start typing the word "Dissolver":

![](./Images/Img1.223.Ex4.AddTransformer.png)

When you see the Dissolver transformer appear in the list, double-click on it to place it into the workspace. The result will look like this:

![](./Images/Img1.224.Ex4.DissolverTransformer.png)

The Dissolver parameter will merge all features with a common attribute value.

<br>**5) Set Dissolver Parameters**
<br>Click on the cogwheel icon on the Dissolver transformer:

![](./Images/Img1.225.Ex4.DissolverParametersButton.png)

Doing so will open a parameters dialog for the transformer. Click the ellipsis (...) button next to the Group By parameter. In the dialog that opens, select the ZoneCategory attribute and click OK:

![](./Images/Img1.226.Ex4.DissolverGroupByParameter.png)

Click OK again to close the parameters dialog.

<br>**6) Inspect with Feature Caching in Visual Preview**
<br>Save the workspace. Let's try using feature caching and Visual Preview now. Click the Dissolver to select it, then click Run to This:

![](./Images/Img1.227.Ex4.RunToThis.png)

Workbench will cache the Zones feature type and then create two caches on the Dissolver: Area and Remnants. As long as the Dissolver remains selected, Remnants will display automatically in Visual Preview because it is the last output port on the transformer, but Area is the one we are interested in. You can change which port is displayed in Visual Preview by unchecking Dissolver_Remnants in the Visual Preview Display Control window:

![](./Images/Img1.228.Ex4.DisplayControl.png)

The Graphics window should now show that the Dissolver has simplified the original data by combining adjacent polygons with the same zoning category:

![](./Images/Img1.229.Ex4.DissolverResults.png)

You can compare the before and after results by selecting the Zones feature type as well as the Dissolver transformer. There are two ways to do that: click to select one, then <kbd>Ctrl</kbd> click to select the other, or click and drag a rectangle to select both:

![](./Images/Img1.230.Ex4.ClickAndDragSelect.png)

Then the original Zones data will be added to your Display Control window and you can toggle the Zones cache on and off to compare (make sure Dissolver_Remnants stays off):

![](./Images/Img1.231.Ex4.CompareCaches.png)

Now that we are using Visual Preview, you should notice that nearly all of the same tools are available here as in Data Inspector. We will be using Visual Preview for the remainder of the course except where noted.

<br>**7) Add Background Map**
<br>When inspecting data it will help to have a background map to provide a sense of location. You can choose from many mapping services.

Click **Add a background map** in the Visual Preview Graphics window toolbar:

![](./Images/Img1.232.Ex4.AddABackgroundMap.png)

---

<!--Tip Section-->

<table style="border-spacing: 0px">
<tr>
<td style="vertical-align:middle;background-color:darkorange;border: 2px solid darkorange">
<i class="fa fa-info-circle fa-lg fa-pull-left fa-fw" style="color:white;padding-right: 12px;vertical-align:text-top"></i>
<span style="color:white;font-size:x-large;font-weight: bold;font-family:serif">TIP</span>
</td>
</tr>

<tr>
<td style="border: 1px solid darkorange">
<span style="font-family:serif; font-style:italic; font-size:larger">
You can right-click the Visual Preview Graphics window and select Background Map > Switch to a new background map, if you prefer:<br>
<img src="./Images/switch-to-a-new-background-map.png" alt=""><br>
This method is sometimes easier when working with smaller screens or Visual Preview.
</span>
</td>
</tr>
</table>

---

In the Add Background Map dialog, click the Source dropdown:

![](./Images/Img1.233.Ex4.BackgroundMapDialog.png)

You will notice that FME supports a variety of background map services. Most require an existing account or server, but for this example let's select Stamen Maps, which we can use without an account.

After selecting Stamen Maps, click the ellipsis button to retrieve the list of background map styles available. Select terrain and click OK:

![](./Images/Img1.234.Ex4.BackgroundMapPropertiesDialog.png)

Click OK and then Save to close these dialogs. A background map is added to the display. Notice that the data is reprojected to match the coordinate system of the chosen background. For example, the Stamen Maps background causes the data to reproject to Spherical Mercator, with a clear change of shape:

![](./Images/Img1.235.Ex4.DataWithBackgroundMap.png)
<br><span style="font-style:italic;font-size:x-small">Map tiles by <a href="https://stamen.com">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0">CC-BY-3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC-BY-SA</a>.</span>


<br>**8) Filter Data**
<br>Let's filter our data to control what is displayed. We'd like to only view industrially-zoned zoning districts.

Click the Visual Preview Graphics window toolbar Filter button:

![](./Images/Img1.236.Ex4.FilterButton.png)

In the Filter Features dialog, check Enable Filter. Then click in the Left Value field and start to type in ZoneCategory. This will search the available attributes:

![](./Images/Img1.237.Ex4.AttributeSearch.png)

Once you see ZoneCategory appear in the list, double-click it to select it. Then click in the Operator field and select the = (equals) symbol, if it is not already selected.

For the Right Value field, click in the field and type the word **Industrial** (don't worry, it's not case-sensitive):

![](./Images/Img1.238.Ex4.OneFilterSet.png)

Click OK to close the dialog. The display will be filtered to show only industrial zones:

![](./Images/Img1.239.Ex4.FilteredData.png)
<br><span style="font-style:italic;font-size:x-small">Map tiles by <a href="https://stamen.com">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0">CC-BY-3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC-BY-SA</a>.</span>

The Display Control Window will also show the effects of the filter:

![](./Images/Img1.240.Ex4.DisplayControlFilter.png)

---

<!--Exercise Congratulations Section-->

<table style="border-spacing: 0px">
<tr>
<td style="vertical-align:middle;background-color:darkorange;border: 2px solid darkorange">
<i class="fa fa-thumbs-o-up fa-lg fa-pull-left fa-fw" style="color:white;padding-right: 12px;vertical-align:text-top"></i>
<span style="color:white;font-size:x-large;font-weight: bold;font-family:serif">CONGRATULATIONS</span>
</td>
</tr>

<tr>
<td style="border: 1px solid darkorange">
<span style="font-family:serif; font-style:italic; font-size:larger">
By completing this exercise you have learned how to:
<br>
<ul>
<li>Set symbology for inspected features</li>
<li>Set a background map for inspecting data</li>
<li>Add a transformer in FME Workbench and set its parameters</li>
<li>Filter inspected data using test clauses</li>
</span>
</td>
</tr>
</table>
